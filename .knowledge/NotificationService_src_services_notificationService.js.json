{"is_source_file": true, "format": "JavaScript", "description": "This file implements a notification service for sending email and SMS notifications. It includes functions to send immediate notifications, schedule future notifications, query notification status, and list notification logs. The module interacts with external providers and repositories, and manages scheduled jobs for delayed delivery.", "external_files": ["../repositories/memoryStore", "./templateService", "./recipientService", "../providers/emailProvider", "../providers/smsProvider", "../utils/logger", "../utils/metrics"], "external_methods": ["getRecipient", "renderTemplate", "sendEmail", "sendSMS", "incCounter", "observeHistogram"], "published": ["send", "schedule", "getStatus", "listLogs"], "classes": [], "methods": [{"name": "resolveDeliveryTargets(recipients)", "description": "Resolves recipient IDs to recipient objects, allowing for ad-hoc recipients if no existing recipient is found.", "scope": "", "scopeKind": ""}, {"name": "deliver(notification)", "description": "Handles the delivery of a notification, sending emails or SMS based on notification type, updating status, and logging metrics.", "scope": "", "scopeKind": ""}, {"name": "send({ type, recipients, templateId, parameters })", "description": "Triggers immediate notification delivery by creating a notification object and calling deliver.", "scope": "", "scopeKind": ""}, {"name": "scheduleNotification({ type, recipients, templateId, parameters, scheduleAt })", "description": "Schedules a notification for later delivery using node-schedule, creating a scheduled job if enabled.", "scope": "", "scopeKind": ""}, {"name": "getStatus(notificationId)", "description": "Retrieves the current status of a notification by its ID.", "scope": "", "scopeKind": ""}, {"name": "listLogs({ recipientId, status, from, to })", "description": "Lists notification logs with optional filters such as recipientId, status, and date range.", "scope": "", "scopeKind": ""}], "calls": ["getRecipient", "renderTemplate", "sendEmail", "sendSMS", "incCounter", "observeHistogram", "notifications.set", "schedule.scheduleJob"], "search-terms": ["notificationService", "scheduleNotification", "deliver", "notifications", "scheduledJobs", "send", "getStatus", "listLogs"], "state": 2, "file_id": 23, "knowledge_revision": 47, "git_revision": "", "ctags": [{"_type": "tag", "name": "deliver", "path": "/home/kavia/workspace/code-generation/legacy-cycle-store-system-migration--cycle-store-4890-4600/NotificationService/src/services/notificationService.js", "pattern": "/^async function deliver(notification) {$/", "language": "JavaScript", "kind": "function", "signature": "(notification)"}, {"_type": "tag", "name": "getStatus", "path": "/home/kavia/workspace/code-generation/legacy-cycle-store-system-migration--cycle-store-4890-4600/NotificationService/src/services/notificationService.js", "pattern": "/^function getStatus(notificationId) {$/", "language": "JavaScript", "kind": "function", "signature": "(notificationId)"}, {"_type": "tag", "name": "listLogs", "path": "/home/kavia/workspace/code-generation/legacy-cycle-store-system-migration--cycle-store-4890-4600/NotificationService/src/services/notificationService.js", "pattern": "/^function listLogs({ recipientId, status, from, to }) {$/", "language": "JavaScript", "kind": "function", "signature": "({ recipientId, status, from, to })"}, {"_type": "tag", "name": "logger", "path": "/home/kavia/workspace/code-generation/legacy-cycle-store-system-migration--cycle-store-4890-4600/NotificationService/src/services/notificationService.js", "pattern": "/^const logger = require('..\\/utils\\/logger');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "notification", "path": "/home/kavia/workspace/code-generation/legacy-cycle-store-system-migration--cycle-store-4890-4600/NotificationService/src/services/notificationService.js", "pattern": "/^  const notification = {$/", "language": "JavaScript", "kind": "class", "scope": "scheduleNotification", "scopeKind": "class"}, {"_type": "tag", "name": "notification", "path": "/home/kavia/workspace/code-generation/legacy-cycle-store-system-migration--cycle-store-4890-4600/NotificationService/src/services/notificationService.js", "pattern": "/^  const notification = {$/", "language": "JavaScript", "kind": "class", "scope": "send", "scopeKind": "class"}, {"_type": "tag", "name": "notificationId", "path": "/home/kavia/workspace/code-generation/legacy-cycle-store-system-migration--cycle-store-4890-4600/NotificationService/src/services/notificationService.js", "pattern": "/^    notificationId: uuidv4(),$/", "language": "JavaScript", "kind": "property", "scope": "scheduleNotification.notification", "scopeKind": "class"}, {"_type": "tag", "name": "notificationId", "path": "/home/kavia/workspace/code-generation/legacy-cycle-store-system-migration--cycle-store-4890-4600/NotificationService/src/services/notificationService.js", "pattern": "/^    notificationId: uuidv4(),$/", "language": "JavaScript", "kind": "property", "scope": "send.notification", "scopeKind": "class"}, {"_type": "tag", "name": "resolveDeliveryTargets", "path": "/home/kavia/workspace/code-generation/legacy-cycle-store-system-migration--cycle-store-4890-4600/NotificationService/src/services/notificationService.js", "pattern": "/^function resolveDeliveryTargets(recipients) {$/", "language": "JavaScript", "kind": "function", "signature": "(recipients)"}, {"_type": "tag", "name": "schedule", "path": "/home/kavia/workspace/code-generation/legacy-cycle-store-system-migration--cycle-store-4890-4600/NotificationService/src/services/notificationService.js", "pattern": "/^const schedule = require('node-schedule');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "scheduleNotification", "path": "/home/kavia/workspace/code-generation/legacy-cycle-store-system-migration--cycle-store-4890-4600/NotificationService/src/services/notificationService.js", "pattern": "/^function scheduleNotification({ type, recipients, templateId, parameters, scheduleAt }) {$/", "language": "JavaScript", "kind": "function", "signature": "({ type, recipients, templateId, parameters, scheduleAt })"}, {"_type": "tag", "name": "scheduledJobs", "path": "/home/kavia/workspace/code-generation/legacy-cycle-store-system-migration--cycle-store-4890-4600/NotificationService/src/services/notificationService.js", "pattern": "/^const scheduledJobs = new Map(); \\/\\/ notificationId -> job$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "send", "path": "/home/kavia/workspace/code-generation/legacy-cycle-store-system-migration--cycle-store-4890-4600/NotificationService/src/services/notificationService.js", "pattern": "/^  send,$/", "language": "JavaScript", "kind": "field", "scope": "module.exports", "scopeKind": "class"}, {"_type": "tag", "name": "send", "path": "/home/kavia/workspace/code-generation/legacy-cycle-store-system-migration--cycle-store-4890-4600/NotificationService/src/services/notificationService.js", "pattern": "/^async function send({ type, recipients, templateId, parameters }) {$/", "language": "JavaScript", "kind": "function", "signature": "({ type, recipients, templateId, parameters })"}, {"_type": "tag", "name": "type", "path": "/home/kavia/workspace/code-generation/legacy-cycle-store-system-migration--cycle-store-4890-4600/NotificationService/src/services/notificationService.js", "pattern": "/^    type,$/", "language": "JavaScript", "kind": "field", "scope": "scheduleNotification.notification", "scopeKind": "class"}, {"_type": "tag", "name": "type", "path": "/home/kavia/workspace/code-generation/legacy-cycle-store-system-migration--cycle-store-4890-4600/NotificationService/src/services/notificationService.js", "pattern": "/^    type,$/", "language": "JavaScript", "kind": "field", "scope": "send.notification", "scopeKind": "class"}], "hash": "38b4b121356d06914a4fe22ff436bd67", "format-version": 4, "code-base-name": "NotificationService", "filename": "NotificationService/src/services/notificationService.js", "fields": [{"name": "notificationId: uuidv4(),", "scope": "scheduleNotification.notification", "scopeKind": "class", "description": "unavailable"}, {"name": "send,", "scope": "module.exports", "scopeKind": "class", "description": "unavailable"}, {"name": "type,", "scope": "scheduleNotification.notification", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"47": ""}]}